{% extends '@App/documentation/document-layout.html.twig' %}

{% block title %}Setup Documentation{% endblock %}

{% block content %}

    <div class="container">
        <h1>Setup</h1>
        <p>These are the basic setup instructions for localhost.</p>

        <ul>
            <li>git clone the repo: <code>git clone https://github.com/phptuts/symfonystarter.git</code></li>
            <li>navigate to the symfonystarter folder: <code>cd symfonystarter</code></li>
            <li>Run <code>mkdir var/jwt</code></li>
            <li>Run <code>openssl genrsa -out var/jwt/private.pem -aes256 4096</code> and write down the pass phrase you
                entered
            </li>
            <li>Run <code>openssl rsa -pubout -in var/jwt/private.pem -out var/jwt/public.pem
                </code> and enter the pass phrase
            </li>
            <li>Install composer and run composer install: <code>composer install</code></li>
            <li>
                Fill in the jws_pass_phrase in the parameters.yml file.  This is the pass phrase you entered in the previous step.
            </li>
            <li>Go to facebook and setup your app.</li>
            <li>Go into your app -> config -> parameters.yml and replace these fields with the right value:
                <ul>
                    <li>facebook_app_secret</li>
                    <li>facebook_app_id</li>
                    <li>facebook_api_version</li>
                </ul>
            </li>
            <li>Go to google setup your app.</li>
            <li>Go into your app -> config -> parameters.yml and replace these fields with the right value:
                <ul>
                    <li>google_client_id:</li>
                    <li>google_client_secret:</li>
                </ul>
            </li>
            <li>
                Go to Amazon and setup your s3 bucket. You will need to create 3 folders or a folder for each
                environment.
                So ours would be dev | test | prod.
                Inside each of those folder you will need create a folder called. profile_pics.
                This is where your user's profile pictures will be stored.
                Here how the "magic" happens:
                <a href="https://github.com/phptuts/symfonystarter/blob/126a5b9441de032ecebd3c643111feb1411eb5dd/src/AppBundle/Controller/AccountSettingController.php#L37-L37">Accounting
                    Controller</a>
                |
                <a href="https://github.com/phptuts/symfonystarter/blob/4a203bee836fdebaadfea4967c5eee7bf2b85d4d/src/ApiBundle/Controller/UserController.php#L212-L212">Api
                    User Controller</a>
            </li>
            <li>
                You will need to fill out these parameters in your parameters.yml file.
                <ul>
                    <li>aws_api_version</li>
                    <li>aws_region</li>
                    <li>aws_s3_bucket_name</li>
                    <li>aws_key</li>
                    <li>aws_secret</li>
                </ul>
            </li>
            <li>
                If you are running apache2 you will need to add this to your conf file.
                <pre>
                    RewriteCond %{HTTP:Authorization} ^(.*)
                    RewriteRule .* - [e=HTTP_AUTHORIZATION:%1]</pre>
                For some crazy reason apache remove Authorization headers.  Don't ask.
            </li>
            <li>Go to your app -> config -> parameters.yml and if you have not already setup your smtp and doctrine
                config.  Also be sure to setup the from_email so that email service knows which email to put from part.
            </li>
            <li>Run <code>bin/console doctrine:database:create</code></li>
            <li>Run <code>bin/console doctrine:migrations:migrate</code></li>
            <li>Run <code>bin/console server:run</code> to see the code in action</li>
        </ul>
    </div>

{% endblock %}

{% block helpfulLinks %}
    <ul>
        <li><a href="http://symfony.com/doc/master/bundles/FOSRestBundle/index.html">FOS Rest Bundle</a></li>
        <li><a href="http://jmsyst.com/bundles/JMSSerializerBundle">JMS Serializer</a></li>
        <li><a href="https://github.com/nelmio/NelmioApiDocBundle">Nelmio Api Doc Bundle</a></li>
        <li><a href="https://aws.amazon.com/documentation/s3/">Amazon S3 Documentation</a></li>
        <li><a href="https://developers.facebook.com/docs/php/howto/example_facebook_login">Facebook Login</a></li>
        <li><a href="https://developers.google.com/api-client-library/php/guide/aaa_idtoken">Google Auth Guide PHP</a></li>

    </ul>
{% endblock %}